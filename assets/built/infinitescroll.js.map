{"version":3,"sources":["infinitescroll.js"],"names":["window","document","console","log","nextElement","querySelector","feedElement","buffer","ticking","loading","lastScrollY","scrollY","lastWindowHeight","innerHeight","lastDocumentHeight","documentElement","scrollHeight","addEventListener","onScroll","passive","onResize","requestTick","onPageLoad","this","status","removeEventListener","response","querySelectorAll","forEach","item","appendChild","resNextElement","href","onUpdate","xhr","XMLHttpRequest","responseType","open","send","requestAnimationFrame"],"mappings":"CAIA,SAAUA,EAAQC,GAGdC,QAAQC,IAAI,kBACZ,IAAIC,EAAcH,EAASI,cAAc,kBACzC,GAAKD,EAAL,CAGA,IAAIE,EAAcL,EAASI,cAAc,cACzC,GAAKC,EAAL,CAEA,IAAIC,EAAS,IAETC,GAAU,EACVC,GAAU,EAEVC,EAAcV,EAAOW,QACrBC,EAAmBZ,EAAOa,YAC1BC,EAAqBb,EAASc,gBAAgBC,aAmElDhB,EAAOiB,iBAAiB,SAAUC,EAAU,CAAEC,SAAS,IACvDnB,EAAOiB,iBAAiB,SAAUG,GAElCC,KApEA,SAASC,IACL,GAAoB,MAAhBC,KAAKC,OAGL,OAFAxB,EAAOyB,oBAAoB,SAAUP,QACrClB,EAAOyB,oBAAoB,SAAUL,GAKtBG,KAAKG,SAASC,iBAAiB,cACrCC,QAAQ,SAASC,GAC1BvB,EAAYwB,YAAYD,KAI5B,IAAIE,EAAiBR,KAAKG,SAASrB,cAAc,kBAC7C0B,EACA3B,EAAY4B,KAAOD,EAAeC,MAElChC,EAAOyB,oBAAoB,SAAUP,GACrClB,EAAOyB,oBAAoB,SAAUL,IAIzCN,EAAqBb,EAASc,gBAAgBC,aAE9CP,EADAD,GAAU,EAId,SAASyB,IAEL,IAAIxB,EAGJ,GAAIC,EAAcE,GAAoBE,EAAqBP,EACvDC,GAAU,MADd,CAKAC,GAAU,EAEV,IAAIyB,EAAM,IAAIlC,EAAOmC,eACrBD,EAAIE,aAAe,WAEnBF,EAAIjB,iBAAiB,OAAQK,GAE7BY,EAAIG,KAAK,MAAOjC,EAAY4B,MAC5BE,EAAII,KAAK,OAGb,SAASjB,IACLb,GAAWR,EAAOuC,sBAAsBN,GACxCzB,GAAU,EAGd,SAASU,IACLR,EAAcV,EAAOW,QACrBU,IAGJ,SAASD,IACLR,EAAmBZ,EAAOa,YAC1BC,EAAqBb,EAASc,gBAAgBC,aAC9CK,KAlFR,CAyFGrB,OAAQC","file":"infinitescroll.js","sourcesContent":["/**\n * Infinite Scroll\n */\n\n(function(window, document) {\n    // next link element\n\n    console.log(\"helloe mellow \");\n    var nextElement = document.querySelector(\"link[rel=next]\");\n    if (!nextElement) return;\n\n    // post feed element\n    var feedElement = document.querySelector(\".post-feed\");\n    if (!feedElement) return;\n\n    var buffer = 300;\n\n    var ticking = false;\n    var loading = false;\n\n    var lastScrollY = window.scrollY;\n    var lastWindowHeight = window.innerHeight;\n    var lastDocumentHeight = document.documentElement.scrollHeight;\n\n    function onPageLoad() {\n        if (this.status === 404) {\n            window.removeEventListener(\"scroll\", onScroll);\n            window.removeEventListener(\"resize\", onResize);\n            return;\n        }\n\n        // append contents\n        var postElements = this.response.querySelectorAll(\".post-card\");\n        postElements.forEach(function(item) {\n            feedElement.appendChild(item);\n        });\n\n        // set next link\n        var resNextElement = this.response.querySelector(\"link[rel=next]\");\n        if (resNextElement) {\n            nextElement.href = resNextElement.href;\n        } else {\n            window.removeEventListener(\"scroll\", onScroll);\n            window.removeEventListener(\"resize\", onResize);\n        }\n\n        // sync status\n        lastDocumentHeight = document.documentElement.scrollHeight;\n        ticking = false;\n        loading = false;\n    }\n\n    function onUpdate() {\n        // return if already loading\n        if (loading) return;\n\n        // return if not scroll to the bottom\n        if (lastScrollY + lastWindowHeight <= lastDocumentHeight - buffer) {\n            ticking = false;\n            return;\n        }\n\n        loading = true;\n\n        var xhr = new window.XMLHttpRequest();\n        xhr.responseType = \"document\";\n\n        xhr.addEventListener(\"load\", onPageLoad);\n\n        xhr.open(\"GET\", nextElement.href);\n        xhr.send(null);\n    }\n\n    function requestTick() {\n        ticking || window.requestAnimationFrame(onUpdate);\n        ticking = true;\n    }\n\n    function onScroll() {\n        lastScrollY = window.scrollY;\n        requestTick();\n    }\n\n    function onResize() {\n        lastWindowHeight = window.innerHeight;\n        lastDocumentHeight = document.documentElement.scrollHeight;\n        requestTick();\n    }\n\n    window.addEventListener(\"scroll\", onScroll, { passive: true });\n    window.addEventListener(\"resize\", onResize);\n\n    requestTick();\n})(window, document);\n"],"sourceRoot":"/source/"}